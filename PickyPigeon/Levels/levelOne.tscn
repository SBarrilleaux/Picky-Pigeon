[gd_scene load_steps=21 format=4 uid="uid://b3ox4v1uf6k3o"]

[ext_resource type="FontFile" uid="uid://c6lb8h4ou5gfa" path="res://BackgroundAndUI/Rubik_Doodle_Shadow_Font/RubikDoodleShadow-Regular.ttf" id="1_2qc8i"]
[ext_resource type="Gradient" uid="uid://bsqdnytxyj05o" path="res://BackgroundAndUI/gradient_placeholder.tres" id="1_jryeg"]
[ext_resource type="Script" uid="uid://du5rertq388rh" path="res://scripts/board_manager.gd" id="2_2qc8i"]
[ext_resource type="Theme" uid="uid://de2n0oa8q8kvm" path="res://BackgroundAndUI/FontTheme.tres" id="2_2ti2u"]
[ext_resource type="TileSet" uid="uid://dsg25f2us8oo6" path="res://BackgroundAndUI/baseTiles.tres" id="4_nmy6e"]
[ext_resource type="StyleBox" uid="uid://odlv7kym1cy4" path="res://BackgroundAndUI/backgroundPanels.tres" id="4_rg8y0"]
[ext_resource type="Script" uid="uid://c7yn3ws1vic0f" path="res://Levels/backgroundTileManager.gd" id="5_1lu10"]
[ext_resource type="PackedScene" uid="uid://c12jrn0err337" path="res://game_over.tscn" id="6_nmy6e"]
[ext_resource type="AudioStream" uid="uid://lfx6yt7mo4bg" path="res://sounds/soundEffectSwoosh.mp3" id="12_yqj4f"]
[ext_resource type="AudioStream" uid="uid://wrw0c818p312" path="res://sounds/soundEffectsPop.mp3" id="13_yqj4f"]

[sub_resource type="GradientTexture2D" id="GradientTexture2D_2ti2u"]
gradient = ExtResource("1_jryeg")
width = 1920
height = 1080
fill_from = Vector2(0.5, 0)
fill_to = Vector2(0.5, 1)

[sub_resource type="Gradient" id="Gradient_qsmd2"]
colors = PackedColorArray(0, 0.905203, 0.767897, 1, 0.634542, 0.8764, 1, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_rg8y0"]
gradient = SubResource("Gradient_qsmd2")

[sub_resource type="Gradient" id="Gradient_1lu10"]

[sub_resource type="GradientTexture2D" id="GradientTexture2D_qsmd2"]
gradient = SubResource("Gradient_1lu10")

[sub_resource type="Gradient" id="Gradient_smfnu"]

[sub_resource type="GradientTexture2D" id="GradientTexture2D_fx57p"]
gradient = SubResource("Gradient_smfnu")

[sub_resource type="Gradient" id="Gradient_ymgk7"]

[sub_resource type="GradientTexture2D" id="GradientTexture2D_mxec8"]
gradient = SubResource("Gradient_ymgk7")

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_2ti2u"]
bg_color = Color(0.225, 0, 0.45, 0.788235)

[node name="Node3D" type="Node3D"]

[node name="Board" type="Node2D" parent="."]

[node name="Background" type="TextureRect" parent="Board"]
z_index = -13
offset_right = 1928.0
offset_bottom = 1102.0
texture = SubResource("GradientTexture2D_2ti2u")

[node name="SideBackground" type="ColorRect" parent="Board/Background"]
visible = false
z_index = -20
layout_mode = 0
offset_right = 1927.0
offset_bottom = 1100.0
color = Color(0.6885, 0, 0.81, 0.180392)

[node name="SideBackground2" type="ColorRect" parent="Board/Background"]
visible = false
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -1931.0
offset_top = -25.0
offset_right = 2.0
offset_bottom = 561.0
grow_horizontal = 0
color = Color(0.1944, 0.40986, 0.81, 0.180392)

[node name="TurnTextPanel" type="Panel" parent="Board/Background"]
z_index = 1
layout_mode = 1
offset_left = 2.0
offset_top = 20.0
offset_right = 321.0
offset_bottom = 279.0
theme_override_styles/panel = ExtResource("4_rg8y0")

[node name="TurnTextLabel" type="Label" parent="Board/Background/TurnTextPanel"]
unique_name_in_owner = true
z_index = 1
layout_mode = 1
offset_left = -45.0
offset_top = 8.6
offset_right = 376.0
offset_bottom = 194.6
theme = ExtResource("2_2ti2u")
theme_override_colors/font_shadow_color = Color(0.16256, 0.606715, 1, 1)
theme_override_fonts/font = ExtResource("1_2qc8i")
theme_override_font_sizes/font_size = 50
text = "Turns
Remaining
__"
horizontal_alignment = 1

[node name="Objectives" type="Panel" parent="Board/Background"]
z_index = 1
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -329.0
offset_top = 20.0
offset_right = -2.0
offset_bottom = 1042.0
grow_horizontal = 0
theme_override_styles/panel = ExtResource("4_rg8y0")

[node name="ItemsText2" type="Label" parent="Board/Background/Objectives"]
unique_name_in_owner = true
z_index = 1
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -328.0
offset_bottom = 186.0
grow_horizontal = 0
theme = ExtResource("2_2ti2u")
theme_override_colors/font_shadow_color = Color(0.16256, 0.606715, 1, 1)
theme_override_fonts/font = ExtResource("1_2qc8i")
theme_override_font_sizes/font_size = 50
text = "Objectives"
horizontal_alignment = 1

[node name="ItemsText" type="Label" parent="Board/Background"]
unique_name_in_owner = true
z_index = 1
layout_mode = 0
offset_left = -43.0
offset_top = 278.6
offset_right = 378.0
offset_bottom = 464.6
theme = ExtResource("2_2ti2u")
theme_override_colors/font_shadow_color = Color(0.16256, 0.606715, 1, 1)
theme_override_fonts/font = ExtResource("1_2qc8i")
theme_override_font_sizes/font_size = 50
text = "Items"
horizontal_alignment = 1

[node name="ItemsPanel" type="Panel" parent="Board/Background"]
z_index = 1
layout_mode = 1
offset_left = 2.0
offset_top = 274.0
offset_right = 321.0
offset_bottom = 661.0
theme_override_styles/panel = ExtResource("4_rg8y0")

[node name="item_removeNibble" type="Button" parent="Board/Background/ItemsPanel"]
layout_mode = 1
anchors_preset = 4
anchor_top = 0.5
anchor_bottom = 0.5
offset_left = 50.0
offset_top = -93.5
offset_right = 114.0
offset_bottom = -29.5
grow_vertical = 2
theme = ExtResource("2_2ti2u")
toggle_mode = true
text = "1"
icon = SubResource("GradientTexture2D_rg8y0")
flat = true
icon_alignment = 1

[node name="Item2" type="Button" parent="Board/Background/ItemsPanel"]
layout_mode = 1
anchors_preset = 4
anchor_top = 0.5
anchor_bottom = 0.5
offset_left = 50.0
offset_top = 81.5
offset_right = 114.0
offset_bottom = 145.5
grow_vertical = 2
theme = ExtResource("2_2ti2u")
toggle_mode = true
icon = SubResource("GradientTexture2D_qsmd2")
flat = true
icon_alignment = 1

[node name="Item3" type="Button" parent="Board/Background/ItemsPanel"]
layout_mode = 1
anchors_preset = 4
anchor_top = 0.5
anchor_bottom = 0.5
offset_left = 200.0
offset_top = -93.5
offset_right = 264.0
offset_bottom = -29.5
grow_vertical = 2
theme = ExtResource("2_2ti2u")
toggle_mode = true
icon = SubResource("GradientTexture2D_fx57p")
flat = true
icon_alignment = 1

[node name="Item4" type="Button" parent="Board/Background/ItemsPanel"]
layout_mode = 1
anchors_preset = 4
anchor_top = 0.5
anchor_bottom = 0.5
offset_left = 200.0
offset_top = 81.5
offset_right = 264.0
offset_bottom = 145.5
grow_vertical = 2
theme = ExtResource("2_2ti2u")
toggle_mode = true
icon = SubResource("GradientTexture2D_mxec8")
flat = true
icon_alignment = 1

[node name="TopBar" type="Panel" parent="Board/Background"]
layout_mode = 0
offset_right = 1936.0
offset_bottom = 20.0
theme_override_styles/panel = SubResource("StyleBoxFlat_2ti2u")

[node name="TopBar2" type="Panel" parent="Board/Background"]
layout_mode = 0
offset_top = 1042.0
offset_right = 1936.0
offset_bottom = 1100.0
theme_override_styles/panel = SubResource("StyleBoxFlat_2ti2u")

[node name="ObjectivesList" type="ItemList" parent="Board/Background"]
unique_name_in_owner = true
z_index = 30
layout_mode = 1
anchors_preset = 6
anchor_left = 1.0
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
offset_left = -316.0
offset_top = -423.0
offset_right = -16.0
offset_bottom = 452.0
grow_horizontal = 0
grow_vertical = 2
theme = ExtResource("2_2ti2u")
allow_search = false
icon_scale = 0.1

[node name="TileMaps" type="Node2D" parent="Board" node_paths=PackedStringArray("boardGrid")]
position = Vector2(320, 20)
scale = Vector2(0.5, 0.5)
script = ExtResource("5_1lu10")
boardGrid = NodePath("../Grid")

[node name="BoardTiles" type="TileMapLayer" parent="Board/TileMaps"]
scale = Vector2(1, -1)
tile_map_data = PackedByteArray("AAAAAAcAAAAAAAAAAAAJAAcAAAAAAAAAAAADAAcAAAACAAAAAAAEAAcAAAACAAEAAAAAAP//AAAAAAEAAAABAP//AAAAAAEAAAACAP//AAAAAAEAAAADAP//AAAAAAEAAAAEAP//AAAAAAEAAAAFAP//AAAAAAEAAAAGAP//AAAAAAEAAAAHAP//AAAAAAEAAAAIAP//AAAAAAEAAAAJAP//AAAAAAEAAAAJAP7/AAAAAAEAAAAIAP7/AAAAAAEAAAAHAP7/AAAAAAEAAAAGAP7/AAAAAAEAAAAFAP7/AAAAAAEAAAAEAP7/AAAAAAEAAAADAP7/AAAAAAEAAAACAP7/AAAAAAEAAAABAP7/AAAAAAEAAAAAAP7/AAAAAAEAAAAAAP3/AAAAAAEAAAAAAPz/AAAAAAEAAAAAAPv/AAAAAAEAAAAAAPr/AAAAAAEAAAAAAPn/AAAAAAEAAAAAAPj/AAAAAAEAAAABAPj/AAAAAAEAAAACAPj/AAAAAAEAAAADAPj/AAAAAAEAAAAEAPj/AAAAAAEAAAAFAPj/AAAAAAEAAAAGAPj/AAAAAAEAAAAHAPj/AAAAAAEAAAAIAPj/AAAAAAEAAAAJAPj/AAAAAAEAAAAJAPn/AAAAAAEAAAAJAPr/AAAAAAEAAAAIAPr/AAAAAAEAAAAIAPv/AAAAAAEAAAAIAPz/AAAAAAEAAAAIAP3/AAAAAAEAAAAJAP3/AAAAAAEAAAAJAPz/AAAAAAEAAAAIAPn/AAAAAAEAAAAHAPn/AAAAAAEAAAAJAPv/AAAAAAEAAAAHAPv/AAAAAAEAAAAHAPz/AAAAAAEAAAAGAPz/AAAAAAEAAAAGAP3/AAAAAAEAAAAFAP3/AAAAAAEAAAADAP3/AAAAAAEAAAACAP3/AAAAAAEAAAABAP3/AAAAAAEAAAABAPz/AAAAAAEAAAABAPv/AAAAAAEAAAABAPr/AAAAAAEAAAABAPn/AAAAAAEAAAACAPn/AAAAAAEAAAADAPn/AAAAAAEAAAAEAPn/AAAAAAEAAAAFAPn/AAAAAAEAAAAGAPr/AAAAAAEAAAAHAPr/AAAAAAEAAAAHAP3/AAAAAAEAAAAFAPz/AAAAAAEAAAAFAPv/AAAAAAEAAAAFAPr/AAAAAAEAAAAEAP3/AAAAAAEAAAACAPz/AAAAAAEAAAACAPv/AAAAAAEAAAADAPv/AAAAAAEAAAAEAPv/AAAAAAEAAAAEAPz/AAAAAAEAAAADAPz/AAAAAAEAAAACAPr/AAAAAAEAAAADAPr/AAAAAAEAAAAEAPr/AAAAAAEAAAAGAPn/AAAAAAEAAAAGAPv/AAAAAAEAAAA=")
tile_set = ExtResource("4_nmy6e")

[node name="OtherBackgroundTiles" type="TileMapLayer" parent="Board/TileMaps"]
modulate = Color(0.681338, 0.804405, 1, 0.560784)
z_index = -13
z_as_relative = false
tile_map_data = PackedByteArray("AAD+/wEAAAAAAAEAAAD+/wAAAAAAAAEAAAD//wAAAAAAAAEAAAD//wEAAAAAAAEAAAD//wIAAAAAAAEAAAD+/wIAAAAAAAEAAAD9/wAAAAAAAAEAAAD9/wEAAAAAAAEAAAD9/wIAAAAAAAEAAAD//wMAAAAAAAEAAAD+/wMAAAAAAAEAAAD9/wMAAAAAAAEAAAD9/wQAAAAAAAEAAAD+/wQAAAAAAAEAAAD//wQAAAAAAAAAAAD//wUAAAAAAAEAAAD+/wUAAAAAAAEAAAD9/wUAAAAAAAEAAAD9/wYAAAAAAAEAAAD+/wYAAAAAAAEAAAD//wYAAAAAAAEAAAD//wcAAAAAAAEAAAD+/wcAAAAAAAEAAAD9/wcAAAAAAAEAAAD9/wgAAAAAAAEAAAD+/wgAAAAAAAEAAAD//wgAAAAAAAEAAAAAAAgAAAAAAAEAAAABAAgAAAAAAAEAAAACAAgAAAAAAAAAAAADAAgAAAAAAAAAAAAEAAgAAAAAAAAAAAAFAAgAAAAAAAAAAAAGAAgAAAAAAAAAAAAHAAgAAAAAAAEAAAAIAAgAAAAAAAEAAAAJAAgAAAAAAAEAAAAKAAgAAAAAAAEAAAALAAgAAAAAAAEAAAAMAAgAAAAAAAEAAAAMAAQAAAAAAAEAAAAMAAMAAAAAAAEAAAALAAMAAAAAAAEAAAAKAAMAAAAAAAEAAAAKAAIAAAAAAAEAAAALAAIAAAAAAAEAAAAMAAIAAAAAAAEAAAAMAAEAAAAAAAEAAAALAAEAAAAAAAEAAAAKAAEAAAAAAAEAAAAKAAAAAAAAAAEAAAALAAAAAAAAAAEAAAAMAAAAAAAAAAEAAAAMAP//AAAAAAEAAAALAP//AAAAAAEAAAAKAP//AAAAAAEAAAAIAP//AAAAAAEAAAAHAP//AAAAAAEAAAAGAP//AAAAAAEAAAAFAP//AAAAAAEAAAAEAP//AAAAAAEAAAADAP//AAAAAAEAAAACAP//AAAAAAEAAAABAP//AAAAAAEAAAD/////AAAAAAEAAAD+////AAAAAAEAAAD9////AAAAAAEAAAD9//7/AAABAAAAAAD+//7/AAABAAAAAAD///7/AAABAAAAAAAAAP7/AAABAAAAAAABAP7/AAABAAAAAAACAP7/AAABAAAAAAADAP7/AAABAAAAAAAEAP7/AAABAAAAAAAFAP7/AAABAAAAAAAGAP7/AAABAAAAAAAHAP7/AAABAAAAAAAIAP7/AAABAAAAAAAJAP7/AAABAAAAAAAKAP7/AAABAAAAAAALAP7/AAABAAAAAAAMAP7/AAABAAAAAAAKAAYAAAAAAAAAAAALAAYAAAAAAAAAAAALAAcAAAAAAAEAAAAMAAcAAAAAAAEAAAAMAAYAAAAAAAAAAAAMAAUAAAAAAAEAAAALAAUAAAAAAAEAAAALAAQAAAAAAAEAAAAKAAQAAAAAAAEAAAAKAAUAAAAAAAEAAAAKAAcAAAAAAAEAAAAJAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAADAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAcAAAAAAAAAAAABAAcAAAAAAAAAAAAGAAcAAAAAAAAAAAAHAAcAAAAAAAAAAAAIAAcAAAAAAAAAAAAJAAcAAAAAAAAAAAAFAAcAAAAAAAAAAAAEAAcAAAAAAAAAAAADAAcAAAAAAAAAAAACAAcAAAAAAAAAAAACAAYAAAAAAAAAAAADAAYAAAAAAAAAAAAEAAYAAAAAAAAAAAAFAAYAAAAAAAAAAAAGAAYAAAAAAAAAAAAIAAYAAAAAAAAAAAAIAAUAAAAAAAAAAAAHAAUAAAAAAAAAAAAGAAUAAAAAAAAAAAAFAAUAAAAAAAAAAAAEAAUAAAAAAAAAAAABAAYAAAAAAAAAAAAHAAYAAAAAAAAAAAAJAAYAAAAAAAAAAAAJAAUAAAAAAAAAAAAGAAQAAAAAAAAAAAAFAAQAAAAAAAAAAAAEAAQAAAAAAAAAAAADAAQAAAAAAAAAAAACAAQAAAAAAAAAAAABAAQAAAAAAAAAAAABAAUAAAAAAAAAAAACAAUAAAAAAAAAAAADAAUAAAAAAAAAAAAJAAQAAAAAAAAAAAAIAAQAAAAAAAAAAAAIAAMAAAAAAAAAAAAHAAMAAAAAAAAAAAAGAAMAAAAAAAAAAAAFAAMAAAAAAAAAAAAEAAIAAAAAAAAAAAADAAIAAAAAAAAAAAACAAIAAAAAAAAAAAABAAIAAAAAAAAAAAABAAMAAAAAAAAAAAACAAMAAAAAAAAAAAADAAMAAAAAAAAAAAAEAAMAAAAAAAAAAAAJAAMAAAAAAAAAAAAIAAIAAAAAAAAAAAAHAAIAAAAAAAAAAAAGAAIAAAAAAAAAAAAFAAIAAAAAAAAAAAAHAAQAAAAAAAAAAAAHAAEAAAAAAAAAAAAGAAEAAAAAAAAAAAAFAAEAAAAAAAAAAAAEAAEAAAAAAAAAAAADAAEAAAAAAAAAAAAJAAIAAAAAAAAAAAAJAAEAAAAAAAAAAAAIAAEAAAAAAAAAAAACAAEAAAAAAAAAAAABAAEAAAAAAAAAAAAJAP//AAAAAAEAAAD8////AAAAAAEAAAAAAP//AAAAAAEAAAA=")
tile_set = ExtResource("4_nmy6e")

[node name="Grid" type="Node2D" parent="Board"]
position = Vector2(-1, 0)
script = ExtResource("2_2qc8i")
width = 10
height = 8
xStart = 385
yStart = 980
offset = 128
emptySpaces = PackedVector2Array(5, 3, 5, 4, 4, 4, 4, 3, 6, 5, 3, 5, 6, 2, 3, 2)
objectiveItems = Array[String](["sunflower", "popcorn", "blueberry"])
objectiveGoalTotal = Array[int]([20, 15, 10])
turnMax = 15

[node name="DestroyTimer" type="Timer" parent="Board/Grid"]
wait_time = 0.2
one_shot = true

[node name="CollapseTimer" type="Timer" parent="Board/Grid"]
wait_time = 0.1
one_shot = true

[node name="RefillTimer" type="Timer" parent="Board/Grid"]
wait_time = 0.4
one_shot = true

[node name="Sounds" type="Node2D" parent="Board/Grid"]

[node name="MoveSound" type="AudioStreamPlayer2D" parent="Board/Grid/Sounds"]
stream = ExtResource("12_yqj4f")
volume_db = 1.19

[node name="DestroySound" type="AudioStreamPlayer2D" parent="Board/Grid/Sounds"]
stream = ExtResource("13_yqj4f")
volume_db = -8.336

[node name="GameOver" parent="Board" instance=ExtResource("6_nmy6e")]
visible = false
z_index = 180
offset_right = 1920.0
offset_bottom = 1080.0

[connection signal="toggled" from="Board/Background/ItemsPanel/item_removeNibble" to="Board/Grid" method="_on_item_remove_nibble_toggled"]
[connection signal="clearScore" from="Board/Grid" to="Board/GameOver" method="_on_grid_clear_score"]
[connection signal="validTiles" from="Board/Grid" to="Board/TileMaps" method="_on_grid_valid_tiles"]
[connection signal="timeout" from="Board/Grid/DestroyTimer" to="Board/Grid" method="_on_destroy_time_timeout"]
[connection signal="timeout" from="Board/Grid/CollapseTimer" to="Board/Grid" method="_on_collapse_timer_timeout"]
[connection signal="timeout" from="Board/Grid/RefillTimer" to="Board/Grid" method="_on_refill_timer_timeout"]
